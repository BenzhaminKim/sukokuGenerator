Object.defineProperty(exports, '__esModule', {
	value: true
});

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

/** @babel */

var _eventKit = require('event-kit');

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _lazyReq = require('lazy-req');

var _lazyReq2 = _interopRequireDefault(_lazyReq);

var lazyReq = (0, _lazyReq2['default'])(require);
var lodash = lazyReq('lodash');
var jshint = lazyReq('jshint');
var jsxhint = lazyReq('jshint-jsx');
var cli = lazyReq('jshint/src/cli');
var loadConfig = lazyReq('./load-config');
var markersByEditorId = {};
var errorsByEditorId = {};

var subscriptionTooltips = new _eventKit.CompositeDisposable();
var subscriptionEvents = new _eventKit.CompositeDisposable();

var _ = undefined;
var statusBar = undefined;

var SUPPORTED_GRAMMARS = ['source.js', 'source.jsx', 'source.js.jsx'];

var currentLine = undefined;
var currentChar = undefined;

var goToError = function goToError() {
	var editor = atom.workspace.getActiveTextEditor();

	if (!editor || !currentLine || !currentChar) {
		return;
	}

	editor.setCursorBufferPosition([currentLine - 1, currentChar - 1]);
};

var jsHintStatusBar = document.createElement('a');
jsHintStatusBar.setAttribute('id', 'jshint-statusbar');
jsHintStatusBar.classList.add('inline-block');
jsHintStatusBar.addEventListener('click', goToError);

var updateStatusText = function updateStatusText(line, character, reason) {
	jsHintStatusBar.textContent = line && character && reason ? 'JSHint ' + line + ':' + character + ' ' + reason : '';
	currentLine = line;
	currentChar = character;
};

var getMarkersForEditor = function getMarkersForEditor(editor) {
	if (editor && markersByEditorId[editor.id]) {
		return markersByEditorId[editor.id];
	}

	return {};
};

var getErrorsForEditor = function getErrorsForEditor(editor) {
	if (errorsByEditorId[editor.id]) {
		return errorsByEditorId[editor.id];
	}

	return [];
};

var destroyMarkerAtRow = function destroyMarkerAtRow(editor, row) {
	if (markersByEditorId[editor.id] && markersByEditorId[editor.id][row]) {
		markersByEditorId[editor.id][row].destroy();
		delete markersByEditorId[editor.id][row];
	}
};

var getRowForError = function getRowForError(error) {
	// JSHint reports `line: 0` when config error
	var line = error[0].line || 1;

	var row = line - 1;

	return row;
};

var clearOldMarkers = function clearOldMarkers(editor, errors) {
	subscriptionTooltips.dispose();
	subscriptionTooltips = new _eventKit.CompositeDisposable();

	var rows = _.map(errors, function (error) {
		return getRowForError(error);
	});

	var oldMarkers = getMarkersForEditor(editor);
	_.each(_.keys(oldMarkers), function (row) {
		if (!_.contains(rows, row)) {
			destroyMarkerAtRow(editor, row);
		}
	});
};

var saveMarker = function saveMarker(editor, marker, row) {
	if (!markersByEditorId[editor.id]) {
		markersByEditorId[editor.id] = {};
	}

	markersByEditorId[editor.id][row] = marker;
};

var getMarkerAtRow = function getMarkerAtRow(editor, row) {
	if (!markersByEditorId[editor.id]) {
		return null;
	}

	return markersByEditorId[editor.id][row];
};

var updateStatusbar = function updateStatusbar() {
	if (!statusBar) {
		return;
	}

	if (!jsHintStatusBar.parentNode) {
		statusBar.addLeftTile({ item: jsHintStatusBar });
	}

	var editor = atom.workspace.getActiveTextEditor();

	if (!editor || !errorsByEditorId[editor.id]) {
		updateStatusText();
		return;
	}

	var line = editor.getCursorBufferPosition().row + 1;
	var error = errorsByEditorId[editor.id][line] || _.first(_.compact(errorsByEditorId[editor.id]));
	error = Array.isArray(error) ? error[0] : {};

	updateStatusText(error.line, error.character, error.reason);
};

var goToNextError = function goToNextError() {
	var editor = atom.workspace.getActiveTextEditor();

	if (!editor || !markersByEditorId[editor.id] || !errorsByEditorId[editor.id]) {
		return;
	}

	var cursorRow = editor.getCursorBufferPosition().row;

	var markerRows = _.sortBy(_.map(_.keys(getMarkersForEditor(editor)), function (x) {
		return Number(x);
	}));
	var nextRow = _.find(markerRows, function (x) {
		return x > cursorRow;
	});
	if (!nextRow) {
		nextRow = _.first(markerRows);
	}
	if (!nextRow) {
		return;
	}

	var errors = errorsByEditorId[editor.id][nextRow + 1];
	if (errors) {
		editor.setCursorBufferPosition([nextRow, errors[0].character - 1]);
	}
};

var getReasonsForError = function getReasonsForError(err) {
	return _.map(err, function (el) {
		return el.character + ': ' + el.reason + ' (' + el.code + ')';
	});
};

var addReasons = function addReasons(editor, marker, error) {
	var row = getRowForError(error);
	var editorElement = atom.views.getView(editor);
	var reasons = '<div class="jshint-errors">' + getReasonsForError(error).join('<br>') + '</div>';
	var target = editorElement.shadowRoot.querySelector('.line-number[data-buffer-row="' + row + '"]');

	if (!target) {
		return;
	}

	var tooltip = atom.tooltips.add(target, {
		title: reasons,
		placement: 'bottom',
		delay: { show: 200 }
	});

	subscriptionTooltips.add(tooltip);
};

var displayError = function displayError(editor, err) {
	var row = getRowForError(err);

	if (getMarkerAtRow(editor, row)) {
		return;
	}

	var marker = editor.markBufferRange([[row, 0], [row, 1]]);
	editor.decorateMarker(marker, { type: 'line', 'class': 'jshint-line' });
	editor.decorateMarker(marker, { type: 'line-number', 'class': 'jshint-line-number' });
	saveMarker(editor, marker, row);
	addReasons(editor, marker, err);
};

var displayErrors = function displayErrors(editor) {
	var errors = _.compact(getErrorsForEditor(editor));
	clearOldMarkers(editor, errors);
	updateStatusbar();
	_.each(errors, function (err) {
		return displayError(editor, err);
	});
};

var removeMarkersForEditorId = function removeMarkersForEditorId(id) {
	if (markersByEditorId[id]) {
		delete markersByEditorId[id];
	}
};

var removeErrorsForEditorId = function removeErrorsForEditorId(id) {
	if (errorsByEditorId[id]) {
		delete errorsByEditorId[id];
	}
};

var lint = function lint() {
	var editor = atom.workspace.getActiveTextEditor();

	if (!editor) {
		return;
	}

	if (SUPPORTED_GRAMMARS.indexOf(editor.getGrammar().scopeName) === -1) {
		return;
	}

	var file = editor.getURI();

	// Hack to make JSHint look for .jshintignore in the correct dir
	// Because JSHint doesn't use its `cwd` option
	process.chdir(_path2['default'].dirname(file));

	// Remove errors and don't lint if file is ignored in .jshintignore
	if (file && cli().gather({ args: [file] }).length === 0) {
		removeErrorsForEditorId(editor.id);
		displayErrors(editor);
		removeMarkersForEditorId(editor.id);
		return;
	}

	var config = file ? loadConfig()(file) : {};
	var linter = atom.config.get('jshint.supportLintingJsx') || atom.config.get('jshint.transformJsx') ? jsxhint().JSXHINT : jshint().JSHINT;

	if (Object.keys(config).length === 0 && atom.config.get('jshint.onlyConfig')) {
		return;
	}

	try {
		linter(editor.getText(), config, config.globals);
	} catch (err) {}

	removeErrorsForEditorId(editor.id);

	// workaround the errors array sometimes containing `null`
	var errors = _.compact(linter.errors);

	if (errors.length > 0) {
		(function () {
			// aggregate same-line errors
			var ret = [];
			_.each(errors, function (el) {
				var l = el.line;

				if (Array.isArray(ret[l])) {
					ret[l].push(el);

					ret[l] = _.sortBy(ret[l], function (el) {
						return el.character;
					});
				} else {
					ret[l] = [el];
				}
			});

			errorsByEditorId[editor.id] = ret;
		})();
	}

	displayErrors(editor);
};

var debouncedLint = null;
var debouncedDisplayErrors = null;
var debouncedUpdateStatusbar = null;

var registerEvents = function registerEvents() {
	subscriptionEvents.dispose();
	subscriptionEvents = new _eventKit.CompositeDisposable();

	updateStatusbar();

	var editor = atom.workspace.getActiveTextEditor();
	if (!editor) {
		return;
	}

	displayErrors(editor);

	if (!atom.config.get('jshint.validateOnlyOnSave')) {
		subscriptionEvents.add(editor.onDidChange(debouncedLint));
		debouncedLint();
	}

	subscriptionEvents.add(editor.onDidSave(debouncedLint));
	subscriptionEvents.add(editor.onDidChangeScrollTop(function () {
		return debouncedDisplayErrors(editor);
	}));
	subscriptionEvents.add(editor.onDidChangeCursorPosition(debouncedUpdateStatusbar));

	subscriptionEvents.add(editor.onDidDestroy(function () {
		removeErrorsForEditorId(editor.id);
		displayErrors(editor);
		removeMarkersForEditorId(editor.id);
	}));
};

var config = {
	onlyConfig: {
		type: 'boolean',
		'default': false,
		description: 'Disable linter if there is no config file found for the linter.'
	},
	validateOnlyOnSave: {
		type: 'boolean',
		'default': false
	},
	supportLintingJsx: {
		type: 'boolean',
		'default': false,
		title: 'Support Linting JSX'
	}
};

exports.config = config;
var subscriptionMain = null;

var activate = function activate() {
	_ = lodash();
	debouncedLint = _.debounce(lint, 200);
	debouncedDisplayErrors = _.debounce(displayErrors, 200);
	debouncedUpdateStatusbar = _.debounce(updateStatusbar, 100);

	subscriptionMain = new _eventKit.CompositeDisposable();
	subscriptionMain.add(atom.workspace.observeActivePaneItem(registerEvents));
	subscriptionMain.add(atom.config.observe('jshint.validateOnlyOnSave', registerEvents));
	subscriptionMain.add(atom.commands.add('atom-workspace', 'jshint:lint', lint));
	subscriptionMain.add(atom.commands.add('atom-workspace', 'jshint:go-to-error', goToError));
	subscriptionMain.add(atom.commands.add('atom-workspace', 'jshint:go-to-next-error', goToNextError));
};

exports.activate = activate;
var deactivate = function deactivate() {
	subscriptionTooltips.dispose();
	subscriptionEvents.dispose();
	subscriptionMain.dispose();
};

exports.deactivate = deactivate;
var consumeStatusBar = function consumeStatusBar(instance) {
	statusBar = instance;
};
exports.consumeStatusBar = consumeStatusBar;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZpbGU6Ly8vQzovVXNlcnMvdXNlci8uYXRvbS9wYWNrYWdlcy9qc2hpbnQvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7d0JBQ2tDLFdBQVc7O29CQUM1QixNQUFNOzs7O3VCQUNDLFVBQVU7Ozs7QUFFbEMsSUFBTSxPQUFPLEdBQUcsMEJBQVksT0FBTyxDQUFDLENBQUM7QUFDckMsSUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ2pDLElBQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUNqQyxJQUFNLE9BQU8sR0FBRyxPQUFPLENBQUMsWUFBWSxDQUFDLENBQUM7QUFDdEMsSUFBTSxHQUFHLEdBQUcsT0FBTyxDQUFDLGdCQUFnQixDQUFDLENBQUM7QUFDdEMsSUFBTSxVQUFVLEdBQUcsT0FBTyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FBQzVDLElBQU0saUJBQWlCLEdBQUcsRUFBRSxDQUFDO0FBQzdCLElBQU0sZ0JBQWdCLEdBQUcsRUFBRSxDQUFDOztBQUU1QixJQUFJLG9CQUFvQixHQUFHLG1DQUF5QixDQUFDO0FBQ3JELElBQUksa0JBQWtCLEdBQUcsbUNBQXlCLENBQUM7O0FBRW5ELElBQUksQ0FBQyxZQUFBLENBQUM7QUFDTixJQUFJLFNBQVMsWUFBQSxDQUFDOztBQUVkLElBQU0sa0JBQWtCLEdBQUcsQ0FDMUIsV0FBVyxFQUNYLFlBQVksRUFDWixlQUFlLENBQ2YsQ0FBQzs7QUFFRixJQUFJLFdBQVcsWUFBQSxDQUFDO0FBQ2hCLElBQUksV0FBVyxZQUFBLENBQUM7O0FBRWhCLElBQU0sU0FBUyxHQUFHLFNBQVosU0FBUyxHQUFTO0FBQ3ZCLEtBQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsbUJBQW1CLEVBQUUsQ0FBQzs7QUFFcEQsS0FBSSxDQUFDLE1BQU0sSUFBSSxDQUFDLFdBQVcsSUFBSSxDQUFDLFdBQVcsRUFBRTtBQUM1QyxTQUFPO0VBQ1A7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QUFTLEdBQUcsUUFBUSxDQUFDO0NBQ3JCLENBQUMiLCJmaWxlIjoiZmlsZTovLy9DOi9Vc2Vycy91c2VyLy5hdG9tL3BhY2thZ2VzL2pzaGludC9pbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKiBAYmFiZWwgKi9cbmltcG9ydCB7Q29tcG9zaXRlRGlzcG9zYWJsZX0gZnJvbSAnZXZlbnQta2l0JztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IGxhenlSZXF1aXJlIGZyb20gJ2xhenktcmVxJztcblxuY29uc3QgbGF6eVJlcSA9IGxhenlSZXF1aXJlKHJlcXVpcmUpO1xuY29uc3QgbG9kYXNoID0gbGF6eVJlcSgnbG9kYXNoJyk7XG5jb25zdCBqc2hpbnQgPSBsYXp5UmVxKCdqc2hpbnQnKTtcbmNvbnN0IGpzeGhpbnQgPSBsYXp5UmVxKCdqc2hpbnQtanN4Jyk7XG5jb25zdCBjbGkgPSBsYXp5UmVxKCdqc2hpbnQvc3JjL2NsaScpO1xuY29uc3QgbG9hZENvbmZpZyA9IGxhenlSZXEoJy4vbG9hZC1jb25maWcnKTtcbmNvbnN0IG1hcmtlcnNCeUVkaXRvcklkID0ge307XG5jb25zdCBlcnJvcnNCeUVkaXRvcklkID0ge307XG5cbmxldCBzdWJzY3JpcHRpb25Ub29sdGlwcyA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCk7XG5sZXQgc3Vic2NyaXB0aW9uRXZlbnRzID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKTtcblxubGV0IF87XG5sZXQgc3RhdHVzQmFyO1xuXG5jb25zdCBTVVBQT1JURURfR1JBTU1BUlMgPSBbXG5cdCdzb3VyY2UuanMnLFxuXHQnc291cmNlLmpzeCcsXG5cdCdzb3VyY2UuanMuanN4J1xuXTtcblxubGV0IGN1cnJlbnRMaW5lO1xubGV0IGN1cnJlbnRDaGFyO1xuXG5jb25zdCBnb1RvRXJyb3IgPSAoKSA9PiB7XG5cdGNvbnN0IGVkaXRvciA9IGF0b20ud29ya3NwYWNlLmdldEFjdGl2ZVRleHRFZGl0b3IoKTtcblxuXHRpZiAoIWVkaXRvciB8fCAhY3VycmVudExpbmUgfHwgIWN1cnJlbnRDaGFyKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0ZWRpdG9yLnNldEN1cnNvckJ1ZmZlclBvc2l0aW9uKFtjdXJyZW50TGluZSAtIDEsIGN1cnJlbnRDaGFyIC0gMV0pO1xufTtcblxuY29uc3QganNIaW50U3RhdHVzQmFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuanNIaW50U3RhdHVzQmFyLnNldEF0dHJpYnV0ZSgnaWQnLCAnanNoaW50LXN0YXR1c2JhcicpO1xuanNIaW50U3RhdHVzQmFyLmNsYXNzTGlzdC5hZGQoJ2lubGluZS1ibG9jaycpO1xuanNIaW50U3RhdHVzQmFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZ29Ub0Vycm9yKTtcblxuY29uc3QgdXBkYXRlU3RhdHVzVGV4dCA9IChsaW5lLCBjaGFyYWN0ZXIsIHJlYXNvbikgPT4ge1xuXHRqc0hpbnRTdGF0dXNCYXIudGV4dENvbnRlbnQgPSBsaW5lICYmIGNoYXJhY3RlciAmJiByZWFzb24gPyBgSlNIaW50ICR7bGluZX06JHtjaGFyYWN0ZXJ9ICR7cmVhc29ufWAgOiAnJztcblx0Y3VycmVudExpbmUgPSBsaW5lO1xuXHRjdXJyZW50Q2hhciA9IGNoYXJhY3Rlcjtcbn07XG5cbmNvbnN0IGdldE1hcmtlcnNGb3JFZGl0b3IgPSBlZGl0b3IgPT4ge1xuXHRpZiAoZWRpdG9yICYmIG1hcmtlcnNCeUVkaXRvcklkW2VkaXRvci5pZF0pIHtcblx0XHRyZXR1cm4gbWFya2Vyc0J5RWRpdG9ySWRbZWRpdG9yLmlkXTtcblx0fVxuXG5cdHJldHVybiB7fTtcbn07XG5cbmNvbnN0IGdldEVycm9yc0ZvckVkaXRvciA9IGVkaXRvciA9PiB7XG5cdGlmIChlcnJvcnNCeUVkaXRvcklkW2VkaXRvci5pZF0pIHtcblx0XHRyZXR1cm4gZXJyb3JzQnlFZGl0b3JJZFtlZGl0b3IuaWRdO1xuXHR9XG5cblx0cmV0dXJuIFtdO1xufTtcblxuY29uc3QgZGVzdHJveU1hcmtlckF0Um93ID0gKGVkaXRvciwgcm93KSA9PiB7XG5cdGlmIChtYXJrZXJzQnlFZGl0b3JJZFtlZGl0b3IuaWRdICYmIG1hcmtlcnNCeUVkaXRvcklkW2VkaXRvci5pZF1bcm93XSkge1xuXHRcdG1hcmtlcnNCeUVkaXRvcklkW2VkaXRvci5pZF1bcm93XS5kZXN0cm95KCk7XG5cdFx0ZGVsZXRlIG1hcmtlcnNCeUVkaXRvcklkW2VkaXRvci5pZF1bcm93XTtcblx0fVxufTtcblxuY29uc3QgZ2V0Um93Rm9yRXJyb3IgPSBlcnJvciA9PiB7XG5cdC8vIEpTSGludCByZXBvcnRzIGBsaW5lOiAwYCB3aGVuIGNvbmZpZyBlcnJvclxuXHRjb25zdCBsaW5lID0gZXJyb3JbMF0ubGluZSB8fCAxO1xuXG5cdGNvbnN0IHJvdyA9IGxpbmUgLSAxO1xuXG5cdHJldHVybiByb3c7XG59O1xuXG5jb25zdCBjbGVhck9sZE1hcmtlcnMgPSAoZWRpdG9yLCBlcnJvcnMpID0+IHtcblx0c3Vic2NyaXB0aW9uVG9vbHRpcHMuZGlzcG9zZSgpO1xuXHRzdWJzY3JpcHRpb25Ub29sdGlwcyA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCk7XG5cblx0Y29uc3Qgcm93cyA9IF8ubWFwKGVycm9ycywgZXJyb3IgPT4gZ2V0Um93Rm9yRXJyb3IoZXJyb3IpKTtcblxuXHRjb25zdCBvbGRNYXJrZXJzID0gZ2V0TWFya2Vyc0ZvckVkaXRvcihlZGl0b3IpO1xuXHRfLmVhY2goXy5rZXlzKG9sZE1hcmtlcnMpLCByb3cgPT4ge1xuXHRcdGlmICghXy5jb250YWlucyhyb3dzLCByb3cpKSB7XG5cdFx0XHRkZXN0cm95TWFya2VyQXRSb3coZWRpdG9yLCByb3cpO1xuXHRcdH1cblx0fSk7XG59O1xuXG5jb25zdCBzYXZlTWFya2VyID0gKGVkaXRvciwgbWFya2VyLCByb3cpID0+IHtcblx0aWYgKCFtYXJrZXJzQnlFZGl0b3JJZFtlZGl0b3IuaWRdKSB7XG5cdFx0bWFya2Vyc0J5RWRpdG9ySWRbZWRpdG9yLmlkXSA9IHt9O1xuXHR9XG5cblx0bWFya2Vyc0J5RWRpdG9ySWRbZWRpdG9yLmlkXVtyb3ddID0gbWFya2VyO1xufTtcblxuY29uc3QgZ2V0TWFya2VyQXRSb3cgPSAoZWRpdG9yLCByb3cpID0+IHtcblx0aWYgKCFtYXJrZXJzQnlFZGl0b3JJZFtlZGl0b3IuaWRdKSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHRyZXR1cm4gbWFya2Vyc0J5RWRpdG9ySWRbZWRpdG9yLmlkXVtyb3ddO1xufTtcblxuY29uc3QgdXBkYXRlU3RhdHVzYmFyID0gKCkgPT4ge1xuXHRpZiAoIXN0YXR1c0Jhcikge1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGlmICghanNIaW50U3RhdHVzQmFyLnBhcmVudE5vZGUpIHtcblx0XHRzdGF0dXNCYXIuYWRkTGVmdFRpbGUoe2l0ZW06IGpzSGludFN0YXR1c0Jhcn0pO1xuXHR9XG5cblx0Y29uc3QgZWRpdG9yID0gYXRvbS53b3Jrc3BhY2UuZ2V0QWN0aXZlVGV4dEVkaXRvcigpO1xuXG5cdGlmICghZWRpdG9yIHx8ICFlcnJvcnNCeUVkaXRvcklkW2VkaXRvci5pZF0pIHtcblx0XHR1cGRhdGVTdGF0dXNUZXh0KCk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Y29uc3QgbGluZSA9IGVkaXRvci5nZXRDdXJzb3JCdWZmZXJQb3NpdGlvbigpLnJvdyArIDE7XG5cdGxldCBlcnJvciA9IGVycm9yc0J5RWRpdG9ySWRbZWRpdG9yLmlkXVtsaW5lXSB8fCBfLmZpcnN0KF8uY29tcGFjdChlcnJvcnNCeUVkaXRvcklkW2VkaXRvci5pZF0pKTtcblx0ZXJyb3IgPSBBcnJheS5pc0FycmF5KGVycm9yKSA/IGVycm9yWzBdIDoge307XG5cblx0dXBkYXRlU3RhdHVzVGV4dChlcnJvci5saW5lLCBlcnJvci5jaGFyYWN0ZXIsIGVycm9yLnJlYXNvbik7XG59O1xuXG5jb25zdCBnb1RvTmV4dEVycm9yID0gKCkgPT4ge1xuXHRjb25zdCBlZGl0b3IgPSBhdG9tLndvcmtzcGFjZS5nZXRBY3RpdmVUZXh0RWRpdG9yKCk7XG5cblx0aWYgKCFlZGl0b3IgfHwgIW1hcmtlcnNCeUVkaXRvcklkW2VkaXRvci5pZF0gfHwgIWVycm9yc0J5RWRpdG9ySWRbZWRpdG9yLmlkXSkge1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGNvbnN0IGN1cnNvclJvdyA9IGVkaXRvci5nZXRDdXJzb3JCdWZmZXJQb3NpdGlvbigpLnJvdztcblxuXHRjb25zdCBtYXJrZXJSb3dzID0gXy5zb3J0QnkoXy5tYXAoXy5rZXlzKGdldE1hcmtlcnNGb3JFZGl0b3IoZWRpdG9yKSksIHggPT4gTnVtYmVyKHgpKSk7XG5cdGxldCBuZXh0Um93ID0gXy5maW5kKG1hcmtlclJvd3MsIHggPT4geCA+IGN1cnNvclJvdyk7XG5cdGlmICghbmV4dFJvdykge1xuXHRcdG5leHRSb3cgPSBfLmZpcnN0KG1hcmtlclJvd3MpO1xuXHR9XG5cdGlmICghbmV4dFJvdykge1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGNvbnN0IGVycm9ycyA9IGVycm9yc0J5RWRpdG9ySWRbZWRpdG9yLmlkXVtuZXh0Um93ICsgMV07XG5cdGlmIChlcnJvcnMpIHtcblx0XHRlZGl0b3Iuc2V0Q3Vyc29yQnVmZmVyUG9zaXRpb24oW25leHRSb3csIGVycm9yc1swXS5jaGFyYWN0ZXIgLSAxXSk7XG5cdH1cbn07XG5cbmNvbnN0IGdldFJlYXNvbnNGb3JFcnJvciA9IGVyciA9PiBfLm1hcChlcnIsIGVsID0+IGAke2VsLmNoYXJhY3Rlcn06ICR7ZWwucmVhc29ufSAoJHtlbC5jb2RlfSlgKTtcblxuY29uc3QgYWRkUmVhc29ucyA9IChlZGl0b3IsIG1hcmtlciwgZXJyb3IpID0+IHtcblx0Y29uc3Qgcm93ID0gZ2V0Um93Rm9yRXJyb3IoZXJyb3IpO1xuXHRjb25zdCBlZGl0b3JFbGVtZW50ID0gYXRvbS52aWV3cy5nZXRWaWV3KGVkaXRvcik7XG5cdGNvbnN0IHJlYXNvbnMgPSBgPGRpdiBjbGFzcz1cImpzaGludC1lcnJvcnNcIj4ke2dldFJlYXNvbnNGb3JFcnJvcihlcnJvcikuam9pbignPGJyPicpfTwvZGl2PmA7XG5cdGNvbnN0IHRhcmdldCA9IGVkaXRvckVsZW1lbnQuc2hhZG93Um9vdC5xdWVyeVNlbGVjdG9yKGAubGluZS1udW1iZXJbZGF0YS1idWZmZXItcm93PVwiJHtyb3d9XCJdYCk7XG5cblx0aWYgKCF0YXJnZXQpIHtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRjb25zdCB0b29sdGlwID0gYXRvbS50b29sdGlwcy5hZGQodGFyZ2V0LCB7XG5cdFx0dGl0bGU6IHJlYXNvbnMsXG5cdFx0cGxhY2VtZW50OiAnYm90dG9tJyxcblx0XHRkZWxheToge3Nob3c6IDIwMH1cblx0fSk7XG5cblx0c3Vic2NyaXB0aW9uVG9vbHRpcHMuYWRkKHRvb2x0aXApO1xufTtcblxuY29uc3QgZGlzcGxheUVycm9yID0gKGVkaXRvciwgZXJyKSA9PiB7XG5cdGNvbnN0IHJvdyA9IGdldFJvd0ZvckVycm9yKGVycik7XG5cblx0aWYgKGdldE1hcmtlckF0Um93KGVkaXRvciwgcm93KSkge1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGNvbnN0IG1hcmtlciA9IGVkaXRvci5tYXJrQnVmZmVyUmFuZ2UoW1tyb3csIDBdLCBbcm93LCAxXV0pO1xuXHRlZGl0b3IuZGVjb3JhdGVNYXJrZXIobWFya2VyLCB7dHlwZTogJ2xpbmUnLCBjbGFzczogJ2pzaGludC1saW5lJ30pO1xuXHRlZGl0b3IuZGVjb3JhdGVNYXJrZXIobWFya2VyLCB7dHlwZTogJ2xpbmUtbnVtYmVyJywgY2xhc3M6ICdqc2hpbnQtbGluZS1udW1iZXInfSk7XG5cdHNhdmVNYXJrZXIoZWRpdG9yLCBtYXJrZXIsIHJvdyk7XG5cdGFkZFJlYXNvbnMoZWRpdG9yLCBtYXJrZXIsIGVycik7XG59O1xuXG5jb25zdCBkaXNwbGF5RXJyb3JzID0gZWRpdG9yID0+IHtcblx0Y29uc3QgZXJyb3JzID0gXy5jb21wYWN0KGdldEVycm9yc0ZvckVkaXRvcihlZGl0b3IpKTtcblx0Y2xlYXJPbGRNYXJrZXJzKGVkaXRvciwgZXJyb3JzKTtcblx0dXBkYXRlU3RhdHVzYmFyKCk7XG5cdF8uZWFjaChlcnJvcnMsIGVyciA9PiBkaXNwbGF5RXJyb3IoZWRpdG9yLCBlcnIpKTtcbn07XG5cbmNvbnN0IHJlbW92ZU1hcmtlcnNGb3JFZGl0b3JJZCA9IGlkID0+IHtcblx0aWYgKG1hcmtlcnNCeUVkaXRvcklkW2lkXSkge1xuXHRcdGRlbGV0ZSBtYXJrZXJzQnlFZGl0b3JJZFtpZF07XG5cdH1cbn07XG5cbmNvbnN0IHJlbW92ZUVycm9yc0ZvckVkaXRvcklkID0gaWQgPT4ge1xuXHRpZiAoZXJyb3JzQnlFZGl0b3JJZFtpZF0pIHtcblx0XHRkZWxldGUgZXJyb3JzQnlFZGl0b3JJZFtpZF07XG5cdH1cbn07XG5cbmNvbnN0IGxpbnQgPSAoKSA9PiB7XG5cdGNvbnN0IGVkaXRvciA9IGF0b20ud29ya3NwYWNlLmdldEFjdGl2ZVRleHRFZGl0b3IoKTtcblxuXHRpZiAoIWVkaXRvcikge1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGlmIChTVVBQT1JURURfR1JBTU1BUlMuaW5kZXhPZihlZGl0b3IuZ2V0R3JhbW1hcigpLnNjb3BlTmFtZSkgPT09IC0xKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Y29uc3QgZmlsZSA9IGVkaXRvci5nZXRVUkkoKTtcblxuXHQvLyBIYWNrIHRvIG1ha2UgSlNIaW50IGxvb2sgZm9yIC5qc2hpbnRpZ25vcmUgaW4gdGhlIGNvcnJlY3QgZGlyXG5cdC8vIEJlY2F1c2UgSlNIaW50IGRvZXNuJ3QgdXNlIGl0cyBgY3dkYCBvcHRpb25cblx0cHJvY2Vzcy5jaGRpcihwYXRoLmRpcm5hbWUoZmlsZSkpO1xuXG5cdC8vIFJlbW92ZSBlcnJvcnMgYW5kIGRvbid0IGxpbnQgaWYgZmlsZSBpcyBpZ25vcmVkIGluIC5qc2hpbnRpZ25vcmVcblx0aWYgKGZpbGUgJiYgY2xpKCkuZ2F0aGVyKHthcmdzOiBbZmlsZV19KS5sZW5ndGggPT09IDApIHtcblx0XHRyZW1vdmVFcnJvcnNGb3JFZGl0b3JJZChlZGl0b3IuaWQpO1xuXHRcdGRpc3BsYXlFcnJvcnMoZWRpdG9yKTtcblx0XHRyZW1vdmVNYXJrZXJzRm9yRWRpdG9ySWQoZWRpdG9yLmlkKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRjb25zdCBjb25maWcgPSBmaWxlID8gbG9hZENvbmZpZygpKGZpbGUpIDoge307XG5cdGNvbnN0IGxpbnRlciA9IChhdG9tLmNvbmZpZy5nZXQoJ2pzaGludC5zdXBwb3J0TGludGluZ0pzeCcpIHx8IGF0b20uY29uZmlnLmdldCgnanNoaW50LnRyYW5zZm9ybUpzeCcpKSA/IGpzeGhpbnQoKS5KU1hISU5UIDoganNoaW50KCkuSlNISU5UO1xuXG5cdGlmIChPYmplY3Qua2V5cyhjb25maWcpLmxlbmd0aCA9PT0gMCAmJiBhdG9tLmNvbmZpZy5nZXQoJ2pzaGludC5vbmx5Q29uZmlnJykpIHtcblx0XHRyZXR1cm47XG5cdH1cblxuXHR0cnkge1xuXHRcdGxpbnRlcihlZGl0b3IuZ2V0VGV4dCgpLCBjb25maWcsIGNvbmZpZy5nbG9iYWxzKTtcblx0fSBjYXRjaCAoZXJyKSB7fVxuXG5cdHJlbW92ZUVycm9yc0ZvckVkaXRvcklkKGVkaXRvci5pZCk7XG5cblx0Ly8gd29ya2Fyb3VuZCB0aGUgZXJyb3JzIGFycmF5IHNvbWV0aW1lcyBjb250YWluaW5nIGBudWxsYFxuXHRjb25zdCBlcnJvcnMgPSBfLmNvbXBhY3QobGludGVyLmVycm9ycyk7XG5cblx0aWYgKGVycm9ycy5sZW5ndGggPiAwKSB7XG5cdFx0Ly8gYWdncmVnYXRlIHNhbWUtbGluZSBlcnJvcnNcblx0XHRjb25zdCByZXQgPSBbXTtcblx0XHRfLmVhY2goZXJyb3JzLCBlbCA9PiB7XG5cdFx0XHRjb25zdCBsID0gZWwubGluZTtcblxuXHRcdFx0aWYgKEFycmF5LmlzQXJyYXkocmV0W2xdKSkge1xuXHRcdFx0XHRyZXRbbF0ucHVzaChlbCk7XG5cblx0XHRcdFx0cmV0W2xdID0gXy5zb3J0QnkocmV0W2xdLCBlbCA9PiBlbC5jaGFyYWN0ZXIpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0W2xdID0gW2VsXTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGVycm9yc0J5RWRpdG9ySWRbZWRpdG9yLmlkXSA9IHJldDtcblx0fVxuXG5cdGRpc3BsYXlFcnJvcnMoZWRpdG9yKTtcbn07XG5cbmxldCBkZWJvdW5jZWRMaW50ID0gbnVsbDtcbmxldCBkZWJvdW5jZWREaXNwbGF5RXJyb3JzID0gbnVsbDtcbmxldCBkZWJvdW5jZWRVcGRhdGVTdGF0dXNiYXIgPSBudWxsO1xuXG5jb25zdCByZWdpc3RlckV2ZW50cyA9ICgpID0+IHtcblx0c3Vic2NyaXB0aW9uRXZlbnRzLmRpc3Bvc2UoKTtcblx0c3Vic2NyaXB0aW9uRXZlbnRzID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKTtcblxuXHR1cGRhdGVTdGF0dXNiYXIoKTtcblxuXHRjb25zdCBlZGl0b3IgPSBhdG9tLndvcmtzcGFjZS5nZXRBY3RpdmVUZXh0RWRpdG9yKCk7XG5cdGlmICghZWRpdG9yKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0ZGlzcGxheUVycm9ycyhlZGl0b3IpO1xuXG5cdGlmICghYXRvbS5jb25maWcuZ2V0KCdqc2hpbnQudmFsaWRhdGVPbmx5T25TYXZlJykpIHtcblx0XHRzdWJzY3JpcHRpb25FdmVudHMuYWRkKGVkaXRvci5vbkRpZENoYW5nZShkZWJvdW5jZWRMaW50KSk7XG5cdFx0ZGVib3VuY2VkTGludCgpO1xuXHR9XG5cblx0c3Vic2NyaXB0aW9uRXZlbnRzLmFkZChlZGl0b3Iub25EaWRTYXZlKGRlYm91bmNlZExpbnQpKTtcblx0c3Vic2NyaXB0aW9uRXZlbnRzLmFkZChlZGl0b3Iub25EaWRDaGFuZ2VTY3JvbGxUb3AoKCkgPT4gZGVib3VuY2VkRGlzcGxheUVycm9ycyhlZGl0b3IpKSk7XG5cdHN1YnNjcmlwdGlvbkV2ZW50cy5hZGQoZWRpdG9yLm9uRGlkQ2hhbmdlQ3Vyc29yUG9zaXRpb24oZGVib3VuY2VkVXBkYXRlU3RhdHVzYmFyKSk7XG5cblx0c3Vic2NyaXB0aW9uRXZlbnRzLmFkZChlZGl0b3Iub25EaWREZXN0cm95KCgpID0+IHtcblx0XHRyZW1vdmVFcnJvcnNGb3JFZGl0b3JJZChlZGl0b3IuaWQpO1xuXHRcdGRpc3BsYXlFcnJvcnMoZWRpdG9yKTtcblx0XHRyZW1vdmVNYXJrZXJzRm9yRWRpdG9ySWQoZWRpdG9yLmlkKTtcblx0fSkpO1xufTtcblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcblx0b25seUNvbmZpZzoge1xuXHRcdHR5cGU6ICdib29sZWFuJyxcblx0XHRkZWZhdWx0OiBmYWxzZSxcblx0XHRkZXNjcmlwdGlvbjogJ0Rpc2FibGUgbGludGVyIGlmIHRoZXJlIGlzIG5vIGNvbmZpZyBmaWxlIGZvdW5kIGZvciB0aGUgbGludGVyLidcblx0fSxcblx0dmFsaWRhdGVPbmx5T25TYXZlOiB7XG5cdFx0dHlwZTogJ2Jvb2xlYW4nLFxuXHRcdGRlZmF1bHQ6IGZhbHNlXG5cdH0sXG5cdHN1cHBvcnRMaW50aW5nSnN4OiB7XG5cdFx0dHlwZTogJ2Jvb2xlYW4nLFxuXHRcdGRlZmF1bHQ6IGZhbHNlLFxuXHRcdHRpdGxlOiAnU3VwcG9ydCBMaW50aW5nIEpTWCdcblx0fVxufTtcblxubGV0IHN1YnNjcmlwdGlvbk1haW4gPSBudWxsO1xuXG5leHBvcnQgY29uc3QgYWN0aXZhdGUgPSAoKSA9PiB7XG5cdF8gPSBsb2Rhc2goKTtcblx0ZGVib3VuY2VkTGludCA9IF8uZGVib3VuY2UobGludCwgMjAwKTtcblx0ZGVib3VuY2VkRGlzcGxheUVycm9ycyA9IF8uZGVib3VuY2UoZGlzcGxheUVycm9ycywgMjAwKTtcblx0ZGVib3VuY2VkVXBkYXRlU3RhdHVzYmFyID0gXy5kZWJvdW5jZSh1cGRhdGVTdGF0dXNiYXIsIDEwMCk7XG5cblx0c3Vic2NyaXB0aW9uTWFpbiA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCk7XG5cdHN1YnNjcmlwdGlvbk1haW4uYWRkKGF0b20ud29ya3NwYWNlLm9ic2VydmVBY3RpdmVQYW5lSXRlbShyZWdpc3RlckV2ZW50cykpO1xuXHRzdWJzY3JpcHRpb25NYWluLmFkZChhdG9tLmNvbmZpZy5vYnNlcnZlKCdqc2hpbnQudmFsaWRhdGVPbmx5T25TYXZlJywgcmVnaXN0ZXJFdmVudHMpKTtcblx0c3Vic2NyaXB0aW9uTWFpbi5hZGQoYXRvbS5jb21tYW5kcy5hZGQoJ2F0b20td29ya3NwYWNlJywgJ2pzaGludDpsaW50JywgbGludCkpO1xuXHRzdWJzY3JpcHRpb25NYWluLmFkZChhdG9tLmNvbW1hbmRzLmFkZCgnYXRvbS13b3Jrc3BhY2UnLCAnanNoaW50OmdvLXRvLWVycm9yJywgZ29Ub0Vycm9yKSk7XG5cdHN1YnNjcmlwdGlvbk1haW4uYWRkKGF0b20uY29tbWFuZHMuYWRkKCdhdG9tLXdvcmtzcGFjZScsICdqc2hpbnQ6Z28tdG8tbmV4dC1lcnJvcicsIGdvVG9OZXh0RXJyb3IpKTtcbn07XG5cbmV4cG9ydCBjb25zdCBkZWFjdGl2YXRlID0gKCkgPT4ge1xuXHRzdWJzY3JpcHRpb25Ub29sdGlwcy5kaXNwb3NlKCk7XG5cdHN1YnNjcmlwdGlvbkV2ZW50cy5kaXNwb3NlKCk7XG5cdHN1YnNjcmlwdGlvbk1haW4uZGlzcG9zZSgpO1xufTtcblxuZXhwb3J0IGNvbnN0IGNvbnN1bWVTdGF0dXNCYXIgPSBpbnN0YW5jZSA9PiB7XG5cdHN0YXR1c0JhciA9IGluc3RhbmNlO1xufTtcbiJdfQ==